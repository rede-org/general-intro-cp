# 5.1  Compositions

## A Web of Association

As mentioned [earlier](../chapter-4-reacting-with-behaviors/4.1-revisiting-hello-world.md#the-concept-of-behavior), contexts bound to the same behavior instance form a relationship. They become associated with one another and indirectly with the other related contexts of each other. Considering this with respect to the logging feature that was implemented throughout the last chapter, it can be said that `App Settings` is associated with `Console Log Route` which is associated with, however briefly, any qualifying `Log Message` contexts before they are deactivated. If there were a `File Log Route` with similar relationships as `Console Log Route`, then it would also be associated with `App Settings` and its qualifying `Log Message` contexts, but not directly associated with `Console Log Route`.

A visualization of these relationships might look something like:

\[Add a graphic depicting the context relationships.]

The associations between contexts form something like a web of app functionality. The web would grow and shrink as the application runs; some contexts may change their direct associates as the result of qualifying for different behaviors, while others may be added or removed. Since contexts bound to a behavior are persisted in memory, the full scope of this web not only shows the relationships of the app's contexts, but also what data is defining the [allocated memory footprint](#user-content-fn-1)[^1] of the application.

One or more of the contexts from this web define a "Composition". The following visualizations all depict compositions for the aforementioned web:

\[A series of graphics depicting the various compositions.]

The purpose of compositions is to group contexts together for [activation](../chapter-4-reacting-with-behaviors/4.2-from-when-to-whenever.md#activating-together), deactivation, or potential [behavior-defined evaluation](5.1-compositions.md#behavior-defined-evaluation).



## Building a Composition

\[Describe how compositions are assembled.]

### Elements of a Composition

\[Describe how any retrieved element of a composition is a composition and how nested compositions work.]

### Explicit Composition Types

\[Describe how explicit composition types can be declared.]



## Behavior-Defined Evaluation

\[Describe how behavior operations can be evaluated with compositions.]

[^1]: This would be less than the total memory usage of the application at any given time though, since operations that are currently running would likely have local data that is in memory for performing logic and the runtime would require some memory as well to manage the contexts themselves.
